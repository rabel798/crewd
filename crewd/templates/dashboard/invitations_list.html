{% extends "dashboard/base_dashboard.html" %}

{% block title %}Project Invitations - Crewd{% endblock %}

{% block dashboard_content %}
<div class="page-header">
    <h1>Project Invitations</h1>
</div>

<div class="dashboard-card">
    <div class="dashboard-card-header">
        <h2 class="dashboard-card-title">Pending Invitations</h2>
    </div>
    <div class="dashboard-card-body">
        <div class="list-group">
            {% for invitation in pending_invitations %}
                <div class="list-item">
                    <div class="list-item-content">
                        <h3>{{ invitation.project.title }}</h3>
                        <p>{{ invitation.project.description|truncatechars:150 }}</p>
                        <p><strong>Team Size:</strong> {{ invitation.project.team_size }} | <strong>Duration:</strong> {{ invitation.project.duration }}</p>
                        <p><strong>Invited by:</strong> {{ invitation.sender.username }}</p>
                        <p><strong>Received:</strong> {{ invitation.created_at|date:"M d, Y" }}</p>
                        {% if invitation.message %}
                            <p><strong>Message:</strong> {{ invitation.message }}</p>
                        {% endif %}
                        <div>
                            {% for skill in invitation.project.get_required_skills_list %}
                                <span class="tech-badge">{{ skill }}</span>
                            {% endfor %}
                        </div>
                        <div class="list-item-actions">
                            <form method="post" action="{% url 'projects:update_invitation' invitation.id %}" style="display: inline-block; margin-right: 10px;">
                                {% csrf_token %}
                                <input type="hidden" name="action" value="accept">
                                <button type="submit" class="btn">Accept</button>
                            </form>
                            <form method="post" action="{% url 'projects:update_invitation' invitation.id %}" style="display: inline-block;">
                                {% csrf_token %}
                                <input type="hidden" name="action" value="reject">
                                <button type="submit" class="btn btn-outline">Reject</button>
                            </form>
                        </div>
                    </div>
                </div>
            {% empty %}
                <p>No pending invitations.</p>
            {% endfor %}
        </div>
    </div>
</div>

<div class="dashboard-card">
    <div class="dashboard-card-header">
        <h2 class="dashboard-card-title">Past Invitations</h2>
    </div>
    <div class="dashboard-card-body">
        <div class="list-group">
            {% for invitation in past_invitations %}
                <div class="list-item">
                    <div class="list-item-content">
                        <h3>{{ invitation.project.title }}</h3>
                        <p><strong>Invited by:</strong> {{ invitation.sender.username }}</p>
                        <p><strong>Received:</strong> {{ invitation.created_at|date:"M d, Y" }}</p>
                        <div>
                            {% if invitation.status == 'accepted' %}
                                <span class="status-label status-accepted">Accepted</span>
                            {% elif invitation.status == 'rejected' %}
                                <span class="status-label status-rejected">Rejected</span>
                            {% endif %}
                        </div>
                    </div>
                </div>
            {% empty %}
                <p>No past invitations.</p>
            {% endfor %}
        </div>
    </div>
</div>
{% endblock %}
